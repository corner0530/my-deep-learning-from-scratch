単語の意味をとらえた表現方法に以下の 3 つがある

- シソーラスによる手法
- カウントベースによる手法
- 推論ベースの手法

# シソーラス

- 類語辞書．同じ意味の単語(同義語)や意味の似た単語(類義語)を同じグループに分類した物．
- 単語の意味を人手で定義している
- 単語の間で，「上位と下位」・「全体と部分」などの細かい関連性が定義されている場合がある

## WordNet

- 最も有名なシソーラス
- 問題点:
  - 時代の変化に対応するのが困難
  - 人の作業コストが高い
  - 単語の細かなニュアンスを表現できない

# カウントベース

- **コーパス**: 大量のテキストデータ
- コーパスから，自動的に効率よく，文書の書き方・単語の選び方・意味などを中質する

## 単語の分散表現

- 単語の意味をベクトルで表現したもの

## 分布仮説

- **単語の意味は，周囲の単語によって形成される**
- コンテキスト: (注目する単語に対して)その周囲に存在する単語
  - コンテキストのサイズをウィンドウサイズという

## 共起行列

- 統計的手法: ある単語に着目した場合，その周囲にどのような単語がどれだけ現れるのかをカウントし，集計する方法
- **共起行列**: 全ての単語に対して，共起する(コンテキストに含まれる)単語をテーブルにまとめたもの
  - 各行が該当する単語のベクトルに対応する

## ベクトル間の類似度

- 単語のベクトル表現の類似度に関しては**コサイン類似度**が良く用いられる．
- コサイン類似度は$\mathbf{x}=\left(x_1,x_2,x_3,\ldots,x_n\right),\mathbf{y}=\left(y_1,y_2,y_3,\ldots,y_n\right)$について，
  $$
  \text{similarity}\left(\mathbf{x},\mathbf{y}\right)=\frac{\mathbf{x}\cdot\mathbf{y}}{\left\|\mathbf{x}\right\|\left\|\mathbf{y}\right\|}=\frac{x_1y_1+\cdots+x_ny_n}{\sqrt{x_1^2+\cdots+x_n^2}\sqrt{y_1^2+\cdots+y_n^2}}
  $$
  ただし$\left\|\cdot\right\|$は L2 ノルム．コサイン類似度は，直感的には「2 つのベクトルがどれだけ同じ方向を向いているか」を表す

## 相互情報量(PMI)

- 共起した回数だけを見るのでは良くないため，相互情報量を用いる．$x,y$を確率変数とし，この値が高いほど関連性が高い．
  $$
  \text{PMI}\left(x,y\right)=\log_2\frac{P\left(x,y\right)}{P\left(x\right)P\left(y\right)}
  $$
  $P(x)$は単語$x$が出現する確率，$P(x,y)$は$x$と$y$が共起する確率．
  ここで単語$x$が出現する回数を$C(x)$，$x$と$y$が共起する回数を$C(x,y)$，コーパスの単語数を$N$として，
  $$
  \text{PMI}\left(x,y\right)=\log_2\frac{C\left(x,y\right)\cdot N}{C\left(x\right)C\left(y\right)}
  $$
  ただし，共起する回数が 0 回だと PMI が負の無限大になるため，実際上は**正の相互情報量**(PPMI)を用いる．
  $$
  \text{PPMI}\left(x,y\right)=\max\left(0,\text{PMI}\left(x,y\right)\right)
  $$

## 次元削減

- ベクトルの次元を「重要な情報」をできるだけ残したうえで削減する手法
  - 疎な行列はより少ない次元で表現しなおせる
- **特異値分解**(SVD): 任意の行列$X$を直交行列$U,V$と対角行列$S$を用いて以下のように分解する
  $$
  X=USV^\top
  $$
  - $U$は直交行列なので何らかの空間の基底を形成している．これを「単語空間」として扱える．
  - $S$は対角行列で，対角成分に「特異値」(「対応する軸」の重要度)が大きい順に並んでいる．→ 重要でない軸を削れる
  - $S$の特異値が小さい部分に相当する列ベクトル(単語ベクトル)を$U$から削ることで元の行列を次元削減できる．
  - 密な行列になるのでノイズに対するロバスト性を高められる

## PTB データセット

- **Penn Treeback**: 手ごろに使えるコーパス
  - 出現の頻度の低い単語を特殊文字で置き換えたり，具体的な数字を`N`で置き換えたりなどしたもの
