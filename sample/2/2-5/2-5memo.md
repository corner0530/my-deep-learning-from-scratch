# リカレントニューラルネットワーク(RNN)

- **フィードフォワード**は流れが一方向のネットワークで，時系列データをうまく扱えないため，RNN を用いる
- **言語モデル**: 単語の並びに対して，それがどれだけ起こりえるのかを確率で評価するモデル
  $$
  P\left(w_1,\ldots,w_m\right)=\prod_{t=1}^mP\left(w_t\mid w_1,\ldots,w_{t-1}\right)
  $$
  - ここで右辺の事後確率は，対象の単語より左の全ての単語をコンテキストとしたときの確率の総乗
- RNN はループする経路を持ちデータが循環する
  - 時刻を$t$として$x_t$を入力とし，$h_t$が出力される
- ループを展開すると，フィードフォワード型と同じ形ですべて同じレイヤにあることになる
- 入力$x$を出力$h$に変換する重み$W_x$と 1 つ前の RNN の出力を次の時刻の出力に変換する重み$W_h$，バイアス$b$を用いて以下のように表せる
  $$
  h_t=\tanh\left(h_{t-1}W_h+x_tW_x+b\right)
  $$
  - なお，$h_t$を**隠れ状態**(**隠れ状態ベクトル**)と呼ばれる
